Sub year_stock() Dim ticker0 As StringDim ticker1 As StringDim stock_open As DoubleDim stock_close As DoubleDim ticker_sum As DoubleDim ticker_row As IntegerDim last_row As LongDim percent_change As DoubleDim date_open As DoubleDim date_close As Doubleticker_sum = 0ticker_row = 2stock_open = 0stock_close = 0percent_change = 0date_open = 20190101date_close = 0  For i = 2 To 760193ticker0 = Cells(i, 1).Valueticker1 = Cells(i + 1, 1).Value      If ticker0 <> ticker1 Then          ticker_sum = ticker_sum + Cells(i, 7).Value                Range("I" & ticker_row).Value = ticker0      Range("L" & ticker_row).Value = ticker_sum      Range("J" & ticker_row).Value = stock_close - stock_open                  If (stock_close - stock_open) > 0 Then                         Range("J" & ticker_row).Interior.ColorIndex = 4                  Else                        Range("J" & ticker_row).Interior.ColorIndex = 3            End If                        If stock_open > 0 Then                    percent_change = ((stock_close - stock_open) / stock_open) * 100                    Range("K" & ticker_row).Value = percent_change              Else                            If stock_open = 0 Then                        percent_change = 0                         Else                            percent_change = -1                    End If                                        Range("K" & ticker_row).Value = percent_change                End If         stock_open = 0    stock_close = 0    date_open = 20170101    date_close = 0    ticker_sum = 0        ticker_row = ticker_row + 1         Else                           If Cells(i, 2).Value < date_open Then                    date_open = Cells(i, 2).Value                    stock_open = Cells(i, 3).Value                End If                             If Cells(i, 2).Value > date_close Then                    date_close = Cells(i, 2).Value                    stock_close = Cells(i, 6).Value                End If                             ticker_sum = ticker_sum + Cells(i, 7).Value                            End If                   Next i  End Sub
